<!DOCTYPE html>
<html>
<head>
<title>Proxy Dashboard</title>
<style type="text/css">
body { background: #000; color: #555; font-family: Helvetica, Arial, san-serif; }
table { margin: 20px auto; }
h1 { text-align: center; }
</style>
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript">
	google.load("visualization", "1", {packages:["corechart"]});
	google.setOnLoadCallback(loadCharts);
	setInterval(loadCharts, 10000);
	function loadCharts() {
		$.get('/progress', function (data) {
			var p = JSON.parse(data);
			$('#progress').text(p.percent);
		});
		$.get('/urls', function (data) {
			var top = JSON.parse(data);
			$('#urls tbody').empty();
			$(top).each(function(index, element){  
			     $('#urls tbody').append('<tr><td>'+(index+1)+'</td><td>'+element[1]+'</td><td>'+element[0]+'</td></tr>');       
			})
		});
		$.get('/minutes', function (data) {
			var chartData = google.visualization.arrayToDataTable(JSON.parse(data));
			var options = {
				title: 'Requests by Minute (past 24 hours)',
				titleTextStyle: { color: '#555' },
				isStacked: true,
				colors: ['blue', 'red'],
				backgroundColor: '#000',
				hAxis: { slantedText: true, slantedTextAngle: 90, textStyle: { color: '#555' } },
				legend: { textStyle: { color: '#555' } }
			};
			var chart = new google.visualization.AreaChart(document.getElementById('chart_minutes'));
			chart.draw(chartData, options);
		});

		$.get('/hours', function(data) {
			var chartData = google.visualization.arrayToDataTable(JSON.parse(data));
			var options = {
				title: 'Requests by Hour (past 30 days)',
				titleTextStyle: { color: '#555' },
				isStacked: true,
				colors: ['blue', 'red'],
				backgroundColor: '#000',
				hAxis: { slantedText: true, slantedTextAngle: 90, textStyle: { color: '#555' } },
				legend: { textStyle: { color: '#555' } }
			};
			var chart = new google.visualization.AreaChart(document.getElementById('chart_hours'));
			chart.draw(chartData, options);
		});

		$.get('/days', function(data) {
			var chartData = google.visualization.arrayToDataTable(JSON.parse(data));
			var options = {
				title: 'Requests by Day (all time)',
				titleTextStyle: { color: '#555' },
				isStacked: true,
				colors: ['blue', 'red'],
				backgroundColor: '#000',
				hAxis: { slantedText: true, slantedTextAngle: 90, textStyle: { color: '#555' } },
				legend: { textStyle: { color: '#555' } }
			};
			var chart = new google.visualization.AreaChart(document.getElementById('chart_days'));
			chart.draw(chartData, options);
		});

	}
</script>
</head>
<body>
<!--<h1><span id="progress">??%</span> Complete</h1>-->
<table id="urls">
	<thead><tr><th>Rank</th><th>Diffs</th><th>URL</th></tr></thead>
	<tbody></tbody>
</table>
<div id="chart_days" style="height: 500px;"></div>
<div id="chart_hours" style="height: 500px;"></div>
<div id="chart_minutes" style="height: 500px;"></div>
</body>
</html>


